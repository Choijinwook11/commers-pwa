(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[727],{1329:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>n});var r=a(7876),t=a(4232),o=a(9099),l=a(8230),d=a.n(l);function n(){let e=(0,o.useRouter)(),{id:s}=e.query,[l,n]=(0,t.useState)(null),[c,m]=(0,t.useState)({date:new Date().toISOString().split("T")[0],medicalHistory:"",managementNotes:"",feedback:"",summary:""}),[i,u]=(0,t.useState)(!1);(0,t.useEffect)(()=>{s&&x()},[s]);let x=async()=>{try{let{db:r}=await a.e(44).then(a.bind(a,5044)),t=await r.getCustomer(s);t?n(t):e.push("/")}catch(e){console.error("Failed to load customer:",e)}},b=e=>{let{name:s,value:a}=e.target;m(e=>({...e,[s]:a}))},h=async r=>{r.preventDefault(),u(!0);try{let{db:r}=await a.e(44).then(a.bind(a,5044)),t={id:"",customerId:s,...c,createdAt:new Date().toISOString()};await r.saveRecord(t),e.push("/customers/".concat(s,"?tab=records&refresh=").concat(Date.now()))}catch(e){console.error("Failed to save record:",e),alert("기록 저장에 실패했습니다.")}finally{u(!1)}};return l?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex justify-between items-center py-4",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(d(),{href:"/customers/".concat(s),className:"text-gray-500 hover:text-gray-700",children:"← 뒤로"}),(0,r.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:[l.name," - 새 기록 추가"]})]})})})}),(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,r.jsxs)("form",{onSubmit:h,className:"bg-white rounded-lg shadow-sm p-6",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700",children:"날짜 *"}),(0,r.jsx)("input",{type:"date",id:"date",name:"date",required:!0,value:c.date,onChange:b,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"medicalHistory",className:"block text-sm font-medium text-gray-700",children:"의료 이력"}),(0,r.jsx)("textarea",{id:"medicalHistory",name:"medicalHistory",rows:4,value:c.medicalHistory,onChange:b,placeholder:"현재 증상, 변화된 의료 상황 등",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"managementNotes",className:"block text-sm font-medium text-gray-700",children:"관리 노트"}),(0,r.jsx)("textarea",{id:"managementNotes",name:"managementNotes",rows:4,value:c.managementNotes,onChange:b,placeholder:"오늘의 관리 내용, 시술 방법, 주의사항 등",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"feedback",className:"block text-sm font-medium text-gray-700",children:"피드백"}),(0,r.jsx)("textarea",{id:"feedback",name:"feedback",rows:4,value:c.feedback,onChange:b,placeholder:"고객의 반응, 만족도, 요청사항 등",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-700",children:"요약"}),(0,r.jsx)("textarea",{id:"summary",name:"summary",rows:3,value:c.summary,onChange:b,placeholder:"오늘 관리의 핵심 요약",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-end space-x-3",children:[(0,r.jsx)(d(),{href:"/customers/".concat(s),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"취소"}),(0,r.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:i?"저장 중...":"저장"})]})]})})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]})})}},5202:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/customers/[id]/records/new",function(){return a(1329)}])},9099:(e,s,a)=>{e.exports=a(8253)}},e=>{var s=s=>e(e.s=s);e.O(0,[230,636,593,792],()=>s(5202)),_N_E=e.O()}]);