(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27],{5522:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/customers/[id]",function(){return t(9365)}])},9099:(e,s,t)=>{e.exports=t(8253)},9365:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(7876),r=t(4232),l=t(9099),c=t(8230),i=t.n(c);function d(){let e=(0,l.useRouter)(),{id:s}=e.query,[c,d]=(0,r.useState)(null),[n,m]=(0,r.useState)([]),[x,o]=(0,r.useState)(!0),[h,g]=(0,r.useState)("info");(0,r.useEffect)(()=>{s&&(b(),"records"===new URLSearchParams(window.location.search).get("tab")&&g("records"))},[s,e.asPath]);let b=async()=>{try{let{db:a}=await t.e(44).then(t.bind(t,5044)),r=await a.getCustomer(s);if(r){d(r);let e=await a.getCustomerRecords(s);m(e)}else e.push("/customers")}catch(e){console.error("Failed to load customer data:",e)}finally{o(!1)}},j=async()=>{if(confirm("정말로 이 고객을 삭제하시겠습니까?"))try{let{db:a}=await t.e(44).then(t.bind(t,5044));await a.deleteCustomer(s),e.push("/customers")}catch(e){console.error("Failed to delete customer:",e)}},p=async e=>{if(confirm("정말로 이 기록을 삭제하시겠습니까?"))try{let{db:a}=await t.e(44).then(t.bind(t,5044));await a.deleteRecord(e);let r=await a.getCustomerRecords(s);m(r)}catch(e){console.error("Failed to delete record:",e)}};return x?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]})}):c?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(i(),{href:"/customers",className:"text-gray-500 hover:text-gray-700",children:"← 뒤로"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:c.name})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(i(),{href:"/customers/".concat(s,"/edit"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"수정"}),(0,a.jsx)("button",{onClick:j,className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"삭제"})]})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>g("info"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("info"===h?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"기본 정보"}),(0,a.jsxs)("button",{onClick:()=>g("records"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("records"===h?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["관리 기록 (",n.length,")"]})]})})}),"info"===h&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"기본 정보"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"이름"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:c.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"전화번호"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:c.phone})]}),c.email&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"이메일"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:c.email})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"의료 정보"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"의료 이력"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:c.medicalHistory||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"문진"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:c.managementNotes||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"피드백"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:c.feedback||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"요약"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:c.summary||"없음"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"등록일"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:new Date(c.createdAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"최종 수정일"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:new Date(c.updatedAt).toLocaleDateString()})]})]})})]}),"records"===h&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["관리 기록 (",n.length,")"]}),(0,a.jsx)(i(),{href:"/customers/".concat(s,"/records/new"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"새 기록 추가"})]}),n.length>0?(0,a.jsx)("div",{className:"space-y-4",children:n.map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:e.date}),(0,a.jsx)("button",{onClick:()=>p(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"삭제"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"의료 이력"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.medicalHistory||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"관리 노트"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.managementNotes||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"피드백"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.feedback||"없음"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"요약"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 whitespace-pre-wrap",children:e.summary||"없음"})]})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"아직 관리 기록이 없습니다."}),(0,a.jsx)(i(),{href:"/customers/".concat(s,"/records/new"),className:"mt-4 inline-block bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"첫 번째 기록 추가"})]})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"고객을 찾을 수 없습니다."}),(0,a.jsx)(i(),{href:"/customers",className:"text-blue-600 hover:underline",children:"고객 목록으로 돌아가기"})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[230,636,593,792],()=>s(5522)),_N_E=e.O()}]);