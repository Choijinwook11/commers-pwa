(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[514],{4152:(e,s,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/daily-log",function(){return l(7716)}])},7716:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>o});var t=l(7876),a=l(4232),r=l(8230),d=l.n(r);function o(){let[e,s]=(0,a.useState)(new Date().toISOString().split("T")[0]),[r,o]=(0,a.useState)([]),[n,c]=(0,a.useState)(null),[i,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{m()},[e]);let m=async()=>{try{let{db:s}=await l.e(44).then(l.bind(l,5044)),t=await s.getAllCustomers();o(t);let a=JSON.parse(localStorage.getItem("daily-logs")||"[]").find(s=>s.date===e);c(a||null)}catch(e){console.error("Failed to load data:",e)}finally{u(!1)}},x=e=>{let s=JSON.parse(localStorage.getItem("daily-logs")||"[]"),l=s.findIndex(s=>s.date===e.date);l>=0?s[l]=e:s.push(e),localStorage.setItem("daily-logs",JSON.stringify(s)),c(e)},b=s=>{let l={customerId:s.id,customerName:s.name,time:"",duration:"",treatment:"",notes:"",satisfaction:3};x({id:(null==n?void 0:n.id)||Date.now().toString(),date:e,customers:[...(null==n?void 0:n.customers)||[],l],notes:(null==n?void 0:n.notes)||"",createdAt:(null==n?void 0:n.createdAt)||new Date().toISOString()})},g=(e,s,l)=>{if(!n)return;let t=[...n.customers];t[e]={...t[e],[s]:l},x({...n,customers:t})},h=e=>{if(!n)return;let s=n.customers.filter((s,l)=>l!==e);x({...n,customers:s})},p=e=>{n&&x({...n,notes:e})};return i?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center py-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(d(),{href:"/",className:"text-gray-500 hover:text-gray-700",children:"← 뒤로"}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"일일 관리일지"})]}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsx)("input",{type:"date",value:e,onChange:e=>s(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})})]})})}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"고객 선택"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"오늘 관리할 고객을 선택하세요"}),(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.map(e=>{var s;let l=null==n||null==(s=n.customers)?void 0:s.some(s=>s.customerId===e.id);return(0,t.jsxs)("button",{onClick:()=>!l&&b(e),disabled:l,className:"w-full text-left p-3 border rounded-lg transition-colors ".concat(l?"border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed":"border-gray-200 hover:bg-gray-50 hover:border-blue-300"),children:[(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.phone}),l&&(0,t.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"✓ 추가됨"})]},e.id)})})]})}),(0,t.jsx)("div",{className:"lg:col-span-2",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:[new Date(e).toLocaleDateString()," 관리일지"]}),(0,t.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,t.jsx)("h4",{className:"text-md font-semibold text-blue-900 mb-3",children:"\uD83D\uDCDD 일일 노트 작성"}),(0,t.jsx)("textarea",{value:(null==n?void 0:n.notes)||"",onChange:e=>p(e.target.value),rows:4,placeholder:"오늘의 관리 노트를 작성하세요...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(null==n?void 0:n.customers)&&n.customers.length>0?(0,t.jsx)("div",{className:"space-y-4",children:n.customers.map((e,s)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:e.customerName}),(0,t.jsx)("button",{onClick:()=>h(s),className:"text-red-600 hover:text-red-800",children:"삭제"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"시간"}),(0,t.jsx)("input",{type:"time",value:e.time,onChange:e=>g(s,"time",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"소요시간"}),(0,t.jsx)("input",{type:"text",value:e.duration,onChange:e=>g(s,"duration",e.target.value),placeholder:"예: 60분",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"치료 내용"}),(0,t.jsx)("textarea",{value:e.treatment,onChange:e=>g(s,"treatment",e.target.value),rows:3,placeholder:"시술한 부위, 사용한 기법, 특이사항 등",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"특이사항"}),(0,t.jsx)("textarea",{value:e.notes,onChange:e=>g(s,"notes",e.target.value),rows:3,placeholder:"고객 반응, 통증 변화, 다음 방문 시 주의사항 등",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"만족도"}),(0,t.jsxs)("select",{value:e.satisfaction,onChange:e=>g(s,"satisfaction",Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:1,children:"1점 - 매우 불만족"}),(0,t.jsx)("option",{value:2,children:"2점 - 불만족"}),(0,t.jsx)("option",{value:3,children:"3점 - 보통"}),(0,t.jsx)("option",{value:4,children:"4점 - 만족"}),(0,t.jsx)("option",{value:5,children:"5점 - 매우 만족"})]})]})]})]},s))}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("p",{children:"오늘 관리할 고객을 선택해주세요."}),(0,t.jsx)("p",{className:"text-sm mt-2",children:"왼쪽 고객 목록에서 고객을 클릭하여 추가하세요."})]})]})})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[230,636,593,792],()=>s(4152)),_N_E=e.O()}]);